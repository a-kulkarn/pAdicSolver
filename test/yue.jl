


using Hecke
using Dory
using AlgebraicSolvers


# For now, we need a fairly large prime. p=7 goes wrong fairly quickly.
Qp = PadicField(89,30)


R, (x1,x2) = PolynomialRing(Qp, ["x1", "x2"])
n = length(gens(R))


R, (p12, p13, p14, p23, p24) = PolynomialRing(Qp, ["p12", "p13", "p14", "p23", "p24"])
n = length(gens(R))

P = [
    p14*p23-p13*p24+p12,89*p14^3+5584059449*p14^2*p24+p14*p24^2+7921*p24^3+3936588805702081*p14^2+62742241*p14*p24+350356403707485209*p24^2+704969*p14+44231334895529*p24+89,267*p13*p14^2+16752178347*p13*p14*p24+3*p13*p24^2+23763*p23*p24^2-5584059449*p12*p14+7873177611404162*p13*p14-7921*p14^2-2*p12*p24+125484482*p13*p24-5584059449*p14*p24+700712807414970418*p23*p24-5584059449*p24^2-62742241*p12+704969*p13-7921*p14+44231334895529*p23-7921*p24-5584059449,5584059449*p12*p14^2+3936588805702081*p13*p14^2+7921*p14^3+2*p12*p14*p24+62742241*p13*p14*p24+5584059449*p14^2*p24+23763*p12*p24^2+350356403707485209*p13*p24^2+5584059449*p14*p24^2+62742241*p12*p14+1409938*p13*p14+7921*p14^2+700712807414970418*p12*p24+88462669791058*p13*p24+7921*p14*p24+44231334895529*p12+267*p13+5584059449*p14,267*p12*p14^2+11168118898*p12*p14*p24-3936588805702081*p13*p14*p24-7921*p14^2*p24+p12*p24^2-62742241*p13*p24^2-5584059449*p14*p24^2-350356403707485209*p23*p24^2-5584059449*p24^3+11809766417106243*p12*p14+125484482*p12*p24-1409938*p13*p24-7921*p14*p24-88462669791058*p23*p24-7921*p24^2+2114907*p12-267*p23-5584059449*p24,267*p13^2*p14+16752178347*p13^2*p24+3*p13*p23*p24+23763*p23^2*p24-11168118898*p12*p13+3936588805702081*p13^2-15842*p13*p14-p12*p23+62742241*p13*p23+350356403707485209*p23^2-11168118898*p13*p24-11168118898*p23*p24+5584059449*p12-7921*p13+496981290961*p14-7921*p23+7921*p24+5584059449,5584059449*p12*p13*p14+3936588805702081*p13^2*p14+7921*p13*p14^2+2*p12*p13*p24+62742241*p13^2*p24+5584059449*p13*p14*p24+23763*p12*p23*p24+350356403707485209*p13*p23*p24+5584059449*p13*p24^2-p12^2+704969*p13^2-5584059449*p12*p14-496981290961*p14^2+350356403707485209*p12*p23+44231334895529*p13*p23-11168118898*p12*p24-7921*p14*p24-7921*p12-5584059449*p13-5584059449*p14,267*p12*p13*p14+11168118898*p12*p13*p24-3936588805702081*p13^2*p24-7921*p13*p14*p24+p12*p23*p24-62742241*p13*p23*p24-350356403707485209*p23^2*p24-5584059449*p13*p24^2-5584059449*p23*p24^2-5584059449*p12^2+7873177611404162*p12*p13-7921*p12*p14+62742241*p12*p23-704969*p13*p23-44231334895529*p23^2+496981290961*p14*p24+7921*p24^2-7921*p12+5584059449*p23+5584059449*p24,p12^2*p14+62742241*p12*p13*p14+704969*p13^2*p14+5584059449*p12*p14^2+7921*p13*p14^2+496981290961*p14^3+23763*p12^2*p24+700712807414970418*p12*p13*p24+44231334895529*p13^2*p24+11168118898*p12*p14*p24+7921*p13*p14*p24+7921*p14^2*p24+350356403707485209*p12^2+88462669791058*p12*p13+267*p13^2+7921*p12*p14+11168118898*p13*p14+5584059449*p14^2,5584059449*p12^2*p14+3936588805702081*p12*p13*p14+7921*p12*p14^2+p12^2*p24-704969*p13^2*p24-7921*p13*p14*p24-496981290961*p14^2*p24-350356403707485209*p12*p23*p24-44231334895529*p13*p23*p24-5584059449*p12*p24^2-7921*p13*p24^2-7921*p14*p24^2+62742241*p12^2+1409938*p12*p13+7921*p12*p14-44231334895529*p12*p23-267*p13*p23-11168118898*p13*p24-5584059449*p14*p24+5584059449*p12,267*p12^2*p14+5584059449*p12^2*p24-7873177611404162*p12*p13*p24-15842*p12*p14*p24-62742241*p12*p23*p24+704969*p13*p23*p24+44231334895529*p23^2*p24-5584059449*p12*p24^2+7921*p13*p24^2+496981290961*p14*p24^2+7921*p23*p24^2+7921*p24^3+11809766417106243*p12^2-2114907*p12*p23+267*p23^2-15842*p12*p24+11168118898*p23*p24+5584059449*p24^2,89*p13^3+5584059449*p13^2*p23+p13*p23^2+7921*p23^3-7921*p13^2-5584059449*p13*p23-5584059449*p23^2+496981290961*p13+7921*p23-350356403707485209,5584059449*p12*p13^2+3936588805702081*p13^3+7921*p13^2*p14+2*p12*p13*p23+62742241*p13^2*p23+23763*p12*p23^2+350356403707485209*p13*p23^2+5584059449*p13^2*p24+5584059449*p13*p23*p24-11168118898*p12*p13-7921*p13^2-993962581922*p13*p14-16752178347*p12*p23-7921*p13*p23-15842*p13*p24+23763*p12+5584059449*p13+1051069211122455627*p14,267*p12*p13^2+11168118898*p12*p13*p23-3936588805702081*p13^2*p23+p12*p23^2-62742241*p13*p23^2-350356403707485209*p23^3-7921*p13^2*p24-5584059449*p13*p23*p24-5584059449*p23^2*p24-15842*p12*p13-5584059449*p12*p23+7921*p13*p23+7921*p23^2+993962581922*p13*p24+15842*p23*p24+496981290961*p12-5584059449*p23-1051069211122455627*p24,p12^2*p13+62742241*p12*p13^2+704969*p13^3+5584059449*p12*p13*p14+7921*p13^2*p14+496981290961*p13*p14^2+23763*p12^2*p23+700712807414970418*p12*p13*p23+44231334895529*p13^2*p23+11168118898*p12*p13*p24+7921*p13^2*p24+7921*p13*p14*p24-16752178347*p12^2-15842*p12*p13-5584059449*p13^2-23763*p12*p14-11168118898*p13*p14-1051069211122455627*p14^2,5584059449*p12^2*p13+3936588805702081*p12*p13^2+7921*p12*p13*p14+p12^2*p23-704969*p13^2*p23-350356403707485209*p12*p23^2-44231334895529*p13*p23^2-7921*p13^2*p24-496981290961*p13*p14*p24-5584059449*p12*p23*p24-7921*p13*p23*p24-7921*p13*p24^2-5584059449*p12^2-496981290961*p12*p14+7921*p12*p23+5584059449*p13*p23+15842*p12*p24+11168118898*p13*p24+1051069211122455627*p14*p24-5584059449*p12,267*p12^2*p13+5584059449*p12^2*p23-7873177611404162*p12*p13*p23-62742241*p12*p23^2+704969*p13*p23^2+44231334895529*p23^3-15842*p12*p13*p24-5584059449*p12*p23*p24+7921*p13*p23*p24+7921*p23^2*p24+496981290961*p13*p24^2+7921*p23*p24^2-7921*p12^2+7921*p12*p23-5584059449*p23^2+993962581922*p12*p24-11168118898*p23*p24-1051069211122455627*p24^2,7921*p12^3+350356403707485209*p12^2*p13+44231334895529*p12*p13^2+89*p13^3+5584059449*p12^2*p14+7921*p12*p13*p14+5584059449*p13^2*p14+7921*p12*p14^2+5584059449*p13*p14^2+350356403707485209*p14^3,p12^3+62742241*p12^2*p13+704969*p12*p13^2+5584059449*p12^2*p14+7921*p12*p13*p14+496981290961*p12*p14^2-350356403707485209*p12^2*p23-88462669791058*p12*p13*p23-267*p13^2*p23-5584059449*p12^2*p24-15842*p12*p13*p24-16752178347*p13^2*p24-15842*p12*p14*p24-16752178347*p13*p14*p24-1051069211122455627*p14^2*p24+7921*p12^2+11168118898*p12*p13+5584059449*p12*p14,5584059449*p12^3+3936588805702081*p12^2*p13+7921*p12^2*p14-62742241*p12^2*p23-1409938*p12*p13*p23+44231334895529*p12*p23^2+267*p13*p23^2-5584059449*p12^2*p24-15842*p12*p13*p24-993962581922*p12*p14*p24+7921*p12*p23*p24+16752178347*p13*p23*p24+7921*p12*p24^2+16752178347*p13*p24^2+1051069211122455627*p14*p24^2+7921*p12^2-5584059449*p12*p23-11168118898*p12*p24,89*p12^3-3936588805702081*p12^2*p23+704969*p12*p23^2-89*p23^3-7921*p12^2*p24+7921*p12*p23*p24-5584059449*p23^2*p24+496981290961*p12*p24^2-5584059449*p23*p24^2-350356403707485209*p24^3];


sol = solve_macaulay(P, gens(R), rho=4)

#matlist, F, B, N, Nr = solve_macaulay(P, gens(R), rho=4, test_mode=true);

#A = matrix(matlist[1]);
#E = eigspaces(A);

# sol = AS.solve_macaulay(P,X)

# println("\n-- sol ")
# println(sol,"\n")

Er = rel_error(P,sol)
println("-- Rel error: ")
display(Er)
println()


